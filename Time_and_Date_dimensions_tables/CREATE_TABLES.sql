-- Create a new table called 'DAYPART_DIM'
-- Drop the table if it already exists
DROP TABLE IF EXISTS DAYPART_DIM;
CREATE TABLE DAYPART_DIM
(
     DAYPART_DIM_PK BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1 MINVALUE 1) PRIMARY KEY 
    ,DAYPART_NAME VARCHAR(20) -- Morning, Dayside, Nightside
    ,DAYPART_START_TIME TIME --,DAYPART_START_TIME VARCHAR(8) -- hh:mm:ss
    ,DAYPART_END_TIME TIME --,DAYPART_END_TIME VARCHAR(8) -- hh:mm:ss
    ,DAYPART_DIM_ETL_CREATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP
    ,DAYPART_DIM_ETL_UPDATED_DATE TIMESTAMP
    ,DAYPART_DIM_ETL_UPDATED_BY VARCHAR(100)
    ,DAYPART_DIM_ETL_BATCH_ID BIGINT
);


-- Create the table in the specified schema
-- Drop the table if it already exists
DROP TABLE IF EXISTS WEEK_DIM;
CREATE TABLE WEEK_DIM
(
     WEEK_DIM_PK    INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1 MINVALUE 1) PRIMARY KEY
    ,WEEK_NUMBER    INTEGER -- 1 - 53
    ,YEAR_WEEK      INTEGER -- YYYYWW ex 202001
    ,WEEK_DIM_ETL_CREATED_DATE    TIMESTAMP DEFAULT CURRENT_TIMESTAMP
    ,WEEK_DIM_ETL_UPDATED_DATE    TIMESTAMP
    ,WEEK_DIM_ETL_UPDATED_BY    VARCHAR(100)
    ,WEEK_DIM_ETL_BATCH_ID    BIGINT
);


-- Create a new table called 'DATE_DIM'
-- Drop the table if it already exists
DROP TABLE IF EXISTS DATE_DIM;
CREATE TABLE DATE_DIM
(
     DATE_DIM_PK BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1 MINVALUE 1) PRIMARY KEY
    ,DATE_CALENDAR TIMESTAMP -- yyyy-mm-dd 00:00:00 RESERVED
    ,YEAR_CALENDAR INTEGER -- yyyy RESERVED
    ,YEAR_MONTH INTEGER --yyyymm
    ,DAY_OF_WEEK VARCHAR(10)
    ,DAY_TYPE VARCHAR(10)
    ,WEEK_DIM_FK BIGINT REFERENCES WEEK_DIM(WEEK_DIM_PK)
    ,WEEK_NUMBER INTEGER
    ,YEAR_WEEK INTEGER
    ,DATE_DIM_ETLCREATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP
    ,DATE_DIM_ETL_UPDATED_DATE TIMESTAMP
    ,DATE_DIM_ETL_UPDATED_BY VARCHAR(100)
    ,DATE_DIM_ETL_BATCH_ID BIGINT
);


-- Create a new table called 'TIME_DIM'
-- Drop the table if it already exists
DROP TABLE IF EXISTS TIME_DIM;
CREATE TABLE TIME_DIM
(
     TIMESTAMP_GMT TIMESTAMP -- nat key
    ,TIMEZONE VARCHAR(50) -- 'Americas/Los_Angeles' define data type na
    ,DATE_DIM_FK BIGINT REFERENCES DATE_DIM(DATE_DIM_PK)
    ,DATE_CALENDAR_TZ DATE
    ,DAY_PART_DIM_FK INTEGER REFERENCES DAYPART_DIM(DAYPART_DIM_PK)
    ,DAYPART_NAME VARCHAR(20)
    ,DAY_TYPE VARCHAR(7)
    ,TIMESTAMP_SECOND_TZ TIMESTAMP -- yyyy-mm-dd hh:mm:ss
    ,TIMESTAMP_MINUTE_TZ TIMESTAMP -- YYYY-MM-DD HH:MM:00
    ,TIMESTAMP_HOUR_TZ TIMESTAMP
    ,TIMESTAMP_5_MINUTE_TZ TIMESTAMP -- 1900-01-01 HH:MM:00
    ,TIMESTAMP_15_MINUTE_TZ TIMESTAMP
    ,TIMESTAMP_HALF_HOUR_TZ TIMESTAMP
    ,TIME_DIM_ETL_CREATED_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP
    ,TIME_DIM_ETL_UPDATED_DATE TIMESTAMP
    ,TIME_DIM_ETL_UPDATED_BY VARCHAR(100)
    ,TIME_DIM_ETL_BATCH_ID BIGINT
    ,CONSTRAINT unique_timestampgtm_timezone UNIQUE(TIMESTAMP_GMT, TIMEZONE)
);


